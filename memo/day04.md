# 상속 관계 매핑

- 기존의 RDB 모델링
  |책| 옷| 운동기구|
  |:--:|:--:|:--:|
  |상품번호(pk) |상품번호 pk| 상품번호pk|
  |이름 | 이름| 이름|
  |가격 | 가격| 가격|
  |저자 | 사이즈| 무게|
  |출판사| 색상| 브랜드|
  |브랜드| ||

### 슈퍼타입 서브타입 관계 모델링

| 상품(슈퍼) |
| :--------: |
| 상품번호pk |
|    이름    |
|    가격    |

서브테이블

|       책        |        옷        |    운동기구     |
| :-------------: | :--------------: | :-------------: |
| 상품번호(pk,fk) | 상품번호 (pk,fk) | 상품번호(pk,fk) |
|      저자       |      사이즈      |      무게       |
|     출판사      |       색상       |     브랜드      |
|     브랜드      |

위의 방식은 논리적인 설계이며 물리적인 구현과는 차이가 있다.

## JPA에서 슈퍼타입 서브타입을 물리적으로 구현하는 3가지 전략

1. 조인전략(Joined)  
   모든 엔티티를 테이블로 만들고 자식 테이블에서 부토 테이블의 pk를 받아 pk+fk로 사용하는 전략  
   테이블이 각각 나눠지므로 조회시 조인을 자주 사용해야한다.  
   객체는 클래스를 타입으로 사용하지만 테이블에는 타입의 개념이 없으므로 타입을 구분할 수 있는 칼럼을 부모테이블에 추가한다.

   |         상품(슈퍼)         |
   | :------------------------: |
   |         상품번호pk         |
   |            이름            |
   |            가격            |
   | 상품타입(책, 옷, 운동기구) |

   서브테이블

   |       책        |        옷        |    운동기구     |
   | :-------------: | :--------------: | :-------------: |
   | 상품번호(pk,fk) | 상품번호 (pk,fk) | 상품번호(pk,fk) |
   |      저자       |      사이즈      |      무게       |
   |     출판사      |       상       |     브랜드      |
   |     브랜드      |

   테이블이 정규화되고 저장공간을 효율적으로 사용하는 장점이 있으나 조회시 조인이 많이 사용되어 쿼리가 복잡해지며, insert를 2번 이상 사용한다는 단점이 있다.(성능 저하)

2. 단일 테이블 전략(Single Table)  
   하나의 테이블로 만든다.   
   어떤 데이터인지 알기 위해서 타입을 저장하며,   
   여러 컬럼에 null을 허용해야한다.
   | 상품 |
   | :--------: |
   | 상품번호pk |
   | 이름 |
   | 가격 |
   | 저자(null 허용) |
   | 출판사(null 허용) |
   | 사이즈(null 허용) |
   | 생상(null 허용) |
   | 브랜드(null 허용) |
   | 무게 |
   | 상품타입(책, 옷, 운동기구) |

   조인이 필요 없으므로 쿼리가 단순하고 빠르다.   
   null을 허용해야하고 테이블이 불필요하게 커진다는 장점이 있다. 

3. 구현 클래스마다 테이블 전략(Table Per Class)  
   일반적인 RDB를 설계하는 방식이다.  
   단점이 많아 추천하지 않는다.
